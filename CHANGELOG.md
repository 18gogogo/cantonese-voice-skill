# 更新日誌（Changelog）

本項目所有重要的變更都會記錄在這個文件中。

---

## [1.5.0] - 2026-02-11

### 新增
- ✅ N100 CPU 實測數據分析基準（1-7 字性能測試）
- ✅ RTF 趨勢線性回歸推斷邏輯
- ✅ 實測推斷邊界（50 秒，9 字）

### 變更
- 🔄 邊界設定：50 秒（33 字）→ 50 秒（9 字）
- 🔄 長文本處理：返回原始文字(完整) + 短文本語音(9字)
- 🔄 處理流程：檢查長度 > 截斷/合成 > 返回完整文字+短文本語音

### 優化
- ⚡ 單例緩存：CosyVoice3 實例初始化 41.60s → <1s（第二次）
- ⚡ 重試機制：成功率 ~60% → ~80%（最多 3 次）
- ⚡ 環境變量：禁用 Triton 優化（減少 C++ 崩潰）
- 🛡️ 超時保護：50 秒限制（線程 Thread.join）
- 🛡️ 自動截斷：9 字邊界（實測推斷）

### 修復
- 🐛 修復長文本處理錯誤（之前返回截斷文字，現在返回完整文字）
- 🐛 修復邊界不合理問題（33 字需要 891 秒，調整為 9 字）
- 🐛 修復語音輸出到 Telegram 失敗問題

### 文檔
- 📝 更新 SETTINGS.md - 實測數據、推斷邏輯、用戶體驗示例
- 📝 更新 README.md - 邊界設定、故障排除
- 📝 更新 INTEGRATION_TELEGRAM.md - 長文本處理規則
- 📝 創建 N100_BOUNDARY_ADJUSTMENT_2026-02-11.md - 完整修正經驗

### 硬體兼容性
- ✅ N100 CPU（Intel N100，4 cores，11GB RAM）
- ✅ 修復版 voice_tts.py（單例緩存 + 重試機制）
- ✅ 語音回應設定（≤9字語音 + >9字原始文字+短文本語音）

---

## [1.3.0] - 2026-02-11 18:00

### 變更
- 🔄 邊界調整：50 秒（33 字）→ 30 秒（7 字）
- 🔄 用戶體驗：≤7 字文字+語音，>7 字僅文字

### 優化
- ⚡ 修復版 TTS（voice_tts_fixed.py）單例緩存
- ⚡ 重試機制（最多 3 次）

### 文檔
- 📝 更新 SETTINGS.md - N100 CPU 優化版邊界

---

## [1.2.0] - 2026-02-11 16:35

### 新增
- ✅ 超時保護機制（50 秒）
- ✅ 自動截斷功能（33 字邊界）

### 變更
- 🔄 語音回應設定：文本 > 33 字自動截斷
- 🔄 處理流程：檢查長度 → 截斷/合成 → 返回文字

### 文檔
- 📝 創建 SETTINGS.md - 性能設定
- 📝 更新 MEMORY.md - 邊界設定記錄

---

## [1.1.0] - 2026-02-11 15:30

### 新增
- ✅ 超時保護機制（選項 C）
- ✅ 進度提示（⏳ 語音合成中...）

### 變更
- 🔄 使用 threading.Thread 實現超時保護

---

## [1.0.0] - 2026-02-11 09:50

### 新增
- ✅ 首次發布GitHub倉庫
- ✅ 語音識別（Whisper Turbo，廣東話）
- ✅ 語音合成（CosyVoice3，廣東話）
- ✅ 語音輸出控制（`（` 和 `）` 控制指令）
- ✅ Telegram 集成支持
- ✅ 雙重保護機制（超時保護 + 自動截斷）

---

## 版本說明

### 版本號格式
- **Major.Minor.Patch**（主版本.次版本.補丁）

### 版本更新規則
- **Major**：重大變更（不兼容舊版）
- **Minor**：新增功能（向下兼容）
- **Patch**：Bug 修復（向下兼容）

---

## 未來計劃

### v1.6.0（規劃中）
- 🔬 研究更快的 TTS 模型（Sherpa-ONNX, Edge-TTS）
- 🔬 GPU 加速支持（15-40x 性能提示）

### v2.0.0（遠期）
- 🚀 NVIDIA GPU 支持
- 🚀 更大的邊界（如 33 字）
- 🚀 實時語音對話

---

**最後更新**: 2026-02-11 18:40
**當前版本**: v1.5.0
**下一版本**: v1.6.0（規劃中）